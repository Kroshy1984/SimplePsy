<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" type="text/css" th:href="@{/css/new-front/global.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/new-front/session/projective-method.css}" />
    <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap"
    />
    <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Rubik:wght@400&display=swap"
    />
</head>
<body>
<div class="root">
    <section class="methodology">
        <form id="sessionForm" th:object="${projectiveMethod}" th:action="@{/SimplePsy/V1/session/report/projective-method}" method="post" enctype="multipart/form-data">
            <input type="hidden" th:value="${sessionId}" name="sessionId">
            <div class="base70"></div>
            <div class="div101">Название методики</div>

            <div class="instructions-parent">
                <div class="instructions">
                    <div class="drawing-area">
                        <input type="text" th:field="*{name}" class="div102" required>
                    </div>
                </div>

                <div class="method-container">
                    <!-- Контейнер для превью изображений -->
                    <div class="image-preview-container" id="imagePreview"></div>
                </div>

                <div class="image-input-wrapper">
                    <div class="image-input">
                        <div class="input-fields">
                            <div class="add-technique-button">
                                <label for="images" class="div105">Добавить фото</label>
                                <input type="file" id="images" accept="image/*" name="image" class="form-input" multiple>
                            </div>
                            <button type="submit" class="add-technique-button">
                                <div class="div105">Добавить методику</div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </section>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const imageInput = document.getElementById('images');
        if (imageInput) {
            imageInput.addEventListener('change', function(event) {
                const previewContainer = document.getElementById('imagePreview');
                previewContainer.innerHTML = ''; // Очистить предыдущие превью

                // Проверяем, есть ли файлы для отображения
                if (event.target.files && event.target.files.length > 0) {
                    Array.from(event.target.files).forEach(file => {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.style.width = '100px';
                            img.style.margin = '5px';
                            previewContainer.appendChild(img); // Добавить изображение в контейнер
                        };
                        reader.readAsDataURL(file); // Прочитать содержимое файла как Data URL
                    });
                }
            });
        } else {
            console.error('Input element with id "images" not found.');
        }
    });
</script>

</body>
</html>
