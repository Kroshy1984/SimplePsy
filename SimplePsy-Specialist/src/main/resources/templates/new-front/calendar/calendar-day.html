<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" type="text/css" th:href="@{/css/new-front/global.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/new-front/calendar/calendar-day.css}" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@400&display=swap"
    />
  </head>
  <body>
  <div class="div37">
    <div class="line34"></div>
    <div class="image-11"></div>
    <div class="inner">
      <header class="frame-header">
        <div class="frame-wrapper6">
          <div class="frame-parent7">
            <div class="icon-parent2">
              <img
                      class="icon23"
                      loading="lazy"
                      alt=""
                      src="/images/icon@2x.png"
              />

              <div class="constructor-wrapper">
                <a class="constructor1">Понятная практика</a>
              </div>
              <div class="icon-parent3">
                <img
                        class="icon24"
                        loading="lazy"
                        alt=""
                        src="/images/icon-1@2x.png"
                />

                <div class="search-input">
                  <input type="text" class = "search1" placeholder="Найти клиента...">
                </div>
              </div>
            </div>
            <div class="main-area-inner">
              <div class="about-us-parent4">
                <a class="about-us16">Добавить клиента</a>
                <a class="news10">Назначить встречу</a>
                <a class="user-policy10">Добавить график нерабочих дней </a>
              </div>
            </div>
          </div>
        </div>
        <div class="icon-parent4">
          <img
                  class="icon25"
                  loading="lazy"
                  alt=""
                  src="/images/icon-2@2x.png"
          />

          <div class="location-name1">
            <select>
              <option value="Rostov" selected>Rostov na Donu</option>
              <option value="Moskva">Moskva</option>
              <option value="Krasnodar">Krasnodar</option>
            </select>
          </div>
        </div>
      </header>
    </div>
    <main class="frame-main">
      <div class="frame-wrapper7">
        <div class="frame-parent8">
          <div class="frame-wrapper8">
            <div class="settings-parent">
              <img
                      class="settings-icon"
                      loading="lazy"
                      alt=""
                      src="/images/settings@2x.png"
              />

              <div class="user-button">
                <div class="wrapper-user1">
                  <img
                          class="user-icon1"
                          loading="lazy"
                          alt=""
                          src="/images/user@2x.png"
                          id="userImage"
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="frame-wrapper9">
            <div class="frame-parent9">
              <div class="hello-rosalie-wrapper">
                <b class="hello-rosalie1">Привет, Антон!</b>
              </div>
              <b class="rosaliericegmailc1">rosalie.rice@gmail.com</b>
            </div>
          </div>
          <div class="frame-parent10">
            <div class="frame-wrapper73">
              <div class="frame-parent122">
                <div class="frame-parent123">
                  <div class="client-list-wrapper">
                    <button class="base90" onclick="window.location.href='/SimplePsy/V1/specialist/customers';"></button>
                    <div class="icon-wrapper33">
                      <img class="icon146" alt="" src="../../../../static/images/icon-3@2x.png" />
                    </div>
                    <b class="client-list fix-font-size">Список клиентов</b>
                  </div>
                  <div class="base-frame">
                    <button class="calendar-wrapper" id="baseContainer" onclick="window.location.href='/SimplePsy/V1/session/calendar';">
                      <div class="icon-wrapper34">
                        <img class="icon147" alt="" src="../../../../static/images/icon-41@2x.png"/>
                      </div>
                      <b class="calendar-navigation fix-font-size">Календарь</b>
                    </button>
                  </div>
                </div>
                <div class="frame-parent123">
                  <div class="notifications-wrapper">
                    <button class="base90 fix-angle-base90" onclick="alert('Эта кнопка находится в разработке')"></button>
                    <div class="icon-wrapper33">
                      <img class="icon146" alt="" src="../../../../static/images/icon-5.svg" />
                    </div>
                    <b class="notifications fix-font-size">Уведомления</b>
                  </div>
                  <div class="base-frame">
                    <button class="calendar-wrapper" id="baseContainer" onclick="alert('Эта кнопка находится в разработке')">
                      <div class="icon-wrapper34">
                        <img class="icon147" alt="" src="../../../../static/images/icon-6.svg"/>
                      </div>
                      <b class="analytics fix-font-size">Аналитика</b>
                    </button>
                  </div>
                  <div class="tests-wrapper">
                    <button class="base94" onclick="window.location.href='/SimplePsy/V1/scoring/list';"></button>
                    <b class="surveys-tests fix-font-size">Опросники и тесты</b>
                  </div>
                </div>
              </div>
            </div>
            <div class="frame-wrapper11">
              <div class="requests-button-parent">
                <div class="requests-button">
                  <b class="b9">Заявки</b>
                </div>
              </div>
            </div>
          </div>
          <div class="feedback-item">
            <div class="feedback-button">
              <img
                      class="icon30"
                      loading="lazy"
                      alt=""
                      src="/images/icon-7@2x.png"
              />

              <div class="frame-parent13">
                <div class="send-feedback-container">
                  <b class="send-feedback1">Обратная связь</b>
                </div>
                <img
                        class="icon31"
                        loading="lazy"
                        alt=""
                        src="/images/icon-8.svg"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <section class="now-parent">

        <div class="base-parent2">




          <div class="calendar">
            <div class="calendar-controls">
              <div class="view-buttons">
                <button id="day-btn" class="button-L" onclick="showDayView()">День</button>
                <button id="week-btn" class="button-C" onclick="showWeekView()">Неделя</button>
                <button id="month-btn" class="button-R" onclick="showMonthView()">Месяц</button>
              </div>
              <div class="month-year">
                <button id="prev-btn"><b>&lt;</b></button>
                <span id="month-year-label"></span>
                <button id="next-btn"><b>&gt;</b></button>
              </div>
            </div>
            <div id="calendar" class="calendar-grid"></div>
          </div>



        </div>
      </section>
    </main>
  </div>
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <div id="modal-body"></div>
    </div>
  </div>
  <script>
    const calendar = document.getElementById('calendar');
    const monthYearLabel = document.getElementById('month-year-label');
    const dayBtn = document.getElementById('day-btn');
    const weekBtn = document.getElementById('week-btn');
    const monthBtn = document.getElementById('month-btn');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    let currentDate = new Date();
    let currentMode = 'month'; // Начальный режим отображения

    // Мок данные событий
    const events = {
      '2024-7-10': ['Встреча', '10:00', '11:00'],
      '2024-7-15': ['Поездка', '14:00', '18:00'],
      '2024-7-20': ['Презентация', '09:00', '10:30'],
    };

    // Функция для отображения текущего дня
    function showDayView() {

      const dayBtn = document.getElementById('day-btn');
      const weekBtn = document.getElementById('week-btn');
      const monthBtn = document.getElementById('month-btn');
      dayBtn.classList.add('active');
      weekBtn.classList.remove('active');
      monthBtn.classList.remove('active');
      calendar.innerHTML = ''; // Очищаем содержимое календаря

      const dayElement = document.createElement('div');
      dayElement.classList.add('day');
      dayElement.textContent = currentDate.getDate();

      // Проверяем, есть ли события на текущий день
      const eventKey = `${currentDate.getFullYear()}-${currentDate.getMonth() + 1}-${currentDate.getDate()}`;
      if (events[eventKey]) {
        const [eventTitle, startTime, endTime] = events[eventKey];
        const dayInfo = document.createElement('div');
        dayInfo.classList.add('day-info');
        dayInfo.innerHTML = `<div class="date">${currentDate.getDate()}</div><div class="event">${eventTitle}</div>`;
        dayElement.appendChild(dayInfo);
      }

      calendar.appendChild(dayElement);
      updateMonthYearLabel();
    }

    // Функция для отображения текущей недели
    function showWeekView() {

      const dayBtn = document.getElementById('day-btn');
      const weekBtn = document.getElementById('week-btn');
      const monthBtn = document.getElementById('month-btn');
      dayBtn.classList.remove('active');
      weekBtn.classList.add('active');
      monthBtn.classList.remove('active');
      calendar.innerHTML = ''; // Очищаем содержимое календаря

      const startOfWeek = new Date(currentDate);
      startOfWeek.setDate(currentDate.getDate() - currentDate.getDay() + 1);

      for (let i = 0; i < 7; i++) {
        const dayElement = document.createElement('div');
        dayElement.classList.add('day');
        dayElement.textContent = startOfWeek.getDate() + i;

        // Проверяем, есть ли события на этот день
        const eventKey = `${startOfWeek.getFullYear()}-${startOfWeek.getMonth() + 1}-${startOfWeek.getDate() + i}`;
        if (events[eventKey]) {
          const [eventTitle, startTime, endTime] = events[eventKey];
          const dayInfo = document.createElement('div');
          dayInfo.classList.add('day-info');
          dayInfo.innerHTML = `<div class="date">${startOfWeek.getDate() + i}</div><div class="event">${eventTitle}</div>`;
          dayElement.appendChild(dayInfo);
        }

        calendar.appendChild(dayElement);
      }

      updateMonthYearLabel();
    }

    // Функция для отображения текущего месяца
    function showMonthView() {

      const dayBtn = document.getElementById('day-btn');
      const weekBtn = document.getElementById('week-btn');
      const monthBtn = document.getElementById('month-btn');
      dayBtn.classList.remove('active');
      weekBtn.classList.remove('active');
      monthBtn.classList.add('active');
      calendar.innerHTML = ''; // Очищаем содержимое календаря

      // Получаем текущий месяц и год
      const currentMonth = currentDate.getMonth();
      const currentYear = currentDate.getFullYear();

      // Получаем количество дней в текущем месяце
      const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

      // Создаем плиточки для каждого дня месяца
      for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = document.createElement('div');
        dayElement.classList.add('day');
        dayElement.textContent = day;

        // Проверяем, есть ли события на этот день
        const eventKey = `${currentYear}-${currentMonth + 1}-${day}`;
        if (events[eventKey]) {
          const [eventTitle, startTime, endTime] = events[eventKey];
          const dayInfo = document.createElement('div');
          dayInfo.classList.add('day-info');
          dayInfo.innerHTML = `<div class="event">${eventTitle}</div>`;
          dayElement.appendChild(dayInfo);
        }

        calendar.appendChild(dayElement);
      }

      updateMonthYearLabel();
    }

    // Функция для обновления надписи с месяцем и годом
    function updateMonthYearLabel() {
      const monthNames = [
        'Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь',
        'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'
      ];
      const monthName = monthNames[currentDate.getMonth()];
      const year = currentDate.getFullYear();
      monthYearLabel.textContent = `${monthName} ${year}`;
    }

    // Обработчики для кнопок переключения режимов
    dayBtn.addEventListener('click', () => {
      currentMode = 'day';
      showDayView();
    });

    weekBtn.addEventListener('click', () => {
      currentMode = 'week';
      showWeekView();
    });

    monthBtn.addEventListener('click', () => {
      currentMode = 'month';
      showMonthView();
    });

    // Обработчики для кнопок предыдущего и следующего месяцев
    prevBtn.addEventListener('click', () => {
      if (currentMode === 'month') {
        currentDate.setMonth(currentDate.getMonth() - 1);
        showMonthView();
      } else if (currentMode === 'week') {
        currentDate.setDate(currentDate.getDate() - 7);
        showWeekView();
      } else if (currentMode === 'day') {
        currentDate.setDate(currentDate.getDate() - 1);
        showDayView();
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentMode === 'month') {
        currentDate.setMonth(currentDate.getMonth() + 1);
        showMonthView();
      } else if (currentMode === 'week') {
        currentDate.setDate(currentDate.getDate() + 7);
        showWeekView();
      } else if (currentMode === 'day') {
        currentDate.setDate(currentDate.getDate() + 1);
        showDayView();
      }
    });

    // По умолчанию показываем месяц
    showMonthView();

  </script>

  <script>
    var aboutUsText = document.getElementById("aboutUsText");
    if (aboutUsText) {
      aboutUsText.addEventListener("click", function (e) {
        // Please sync "Модальное окно "Добавить клиента"" to the project
      });
    }

    var newsText = document.getElementById("newsText");
    if (newsText) {
      newsText.addEventListener("click", function (e) {
        // Please sync "Модальное окно "Назначить встречу" Тип встерча = Встреча с клиентом" to the project
      });
    }

    var userPolicyText = document.getElementById("userPolicyText");
    if (userPolicyText) {
      userPolicyText.addEventListener("click", function (e) {
        // Please sync "Модальное окно "Добавить график  нерабочих дней "" to the project
      });
    }

    var userImage = document.getElementById("userImage");
    if (userImage) {
      userImage.addEventListener("click", function (e) {
        window.location.href = "./component4.html";
      });
    }

    var dashboardContainer = document.getElementById("dashboardContainer");
    if (dashboardContainer) {
      dashboardContainer.addEventListener("click", function (e) {
        window.location.href = "./component2.html";
      });
    }

    var invoiceContainer = document.getElementById("invoiceContainer");
    if (invoiceContainer) {
      invoiceContainer.addEventListener("click", function (e) {
        window.location.href = "./component3.html";
      });
    }

    var container = document.getElementById("container");
    if (container) {
      container.addEventListener("click", function (e) {
        window.location.href = "./component2.html";
      });
    }

    var groupContainer = document.getElementById("groupContainer");
    if (groupContainer) {
      groupContainer.addEventListener("click", function (e) {
        window.location.href = "./component12.html";
      });
    }

    var groupContainer1 = document.getElementById("groupContainer1");
    if (groupContainer1) {
      groupContainer1.addEventListener("click", function (e) {
        window.location.href = "./component12.html";
      });
    }
    // Открытие модального окна создания сессии
    document.addEventListener('DOMContentLoaded', function() {
    // Получаем элементы
    var modal = document.getElementById('modal');
    var modalBody = document.getElementById('modal-body');
    var closeBtn = document.querySelector('.close-btn');
    var appointLink = document.querySelector('.news10'); // Элемент "Назначить встречу"

    // Функция для открытия модального окна
      function openModal() {
        fetch('http://localhost:8081/SimplePsy/V1/session/session-form')
                .then(response => response.text())
                .then(data => {
                  modalBody.innerHTML = data;
                  modal.style.display = 'block';
                })
                .catch(error => console.error('Ошибка загрузки:', error));

        fetch('/SimplePsy/V1/client/findAll')
                .then(response => response.json())
                .then(clients => {
                  const dataList = document.getElementById('clientsList');
                  dataList.innerHTML = '';

                  clients.forEach(client => {
                    const option = document.createElement('option');
                    option.value = client.name;
                    option.setAttribute('data-id', client.id);
                    dataList.appendChild(option);
                  });
                })
                .catch(error => console.error('Ошибка:', error));

        const script = document.createElement('script');
        script.id = 'dynamic-script';
        script.textContent = `
                   document.getElementById('clientInput').addEventListener('change', function() {
        const selectedOption = Array.from(document.getElementById('clientsList').options)
                .find(option => option.value === this.value);
        if (selectedOption) {
          const clientId = selectedOption.getAttribute('data-id');
          document.getElementById('clientId').value = clientId; // устанавливаем значение скрытого поля
          document.getElementById('error-message').style.display = 'none'; // Скрываем сообщение об ошибке при успешном выборе клиента
        } else {
          document.getElementById('clientId').value = ''; // Очищаем скрытое поле, если выбранного клиента нет в списке
        }
      });`;
        document.body.appendChild(script);
      }

      // Функция для закрытия модального окна
      function closeModal() {
        modal.style.display = 'none';
        const script = document.getElementById('dynamic-script');
        if (script) {
          script.remove();
          console.log('Скрипт удалён');
        } else {
          console.log('Скрипт не найден');
        }
      }

    // Событие клика для открытия модального окна
    appointLink.addEventListener('click', openModal);

    // Событие клика для закрытия модального окна
    closeBtn.addEventListener('click', closeModal);
    });
  </script>
  </body>
</html>
