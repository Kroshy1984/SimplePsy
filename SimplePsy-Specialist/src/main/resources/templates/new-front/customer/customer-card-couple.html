<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, width=device-width" />

  <link rel="stylesheet" type="text/css" th:href="@{/css/new-front/global.css}" />
  <link rel="stylesheet" type="text/css" th:href="@{/css/new-front/customer/customer-card-couple.css}" />
  <link
          rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap"
  />
  <link
          rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Rubik:wght@400&display=swap"
  />
</head>
<body>
<form th:action="@{/SimplePsy/V1/customer/new}" th:object="${customer}" method="post">
<input th:name="${customer.id}" th:field="*{id}" hidden="hidden" disabled>
<div class="div216">
  <div class="settings6"></div>
  <div class="item112">
    <img class="feather-icon-chevron-up21" alt="" />
  </div>
  <section class="frame-parent141">
    <header class="frame-wrapper85">
      <div class="frame-parent142">
        <div class="frame-wrapper86">
          <div class="frame-parent143">
            <div class="icon-parent29">
              <img
                      class="icon156"
                      loading="lazy"
                      alt=""
                      src="/images/icon@2x.png"
              />

              <div class="constructor-wrapper4">
                <a class="constructor12" href="/SimplePsy/V1/session/calendar">Понятная практика</a>
              </div>
              <div class="icon-parent30">
                <img
                        class="icon157"
                        loading="lazy"
                        alt=""
                        src="/images/icon-1@2x.png"
                />
                <input type="hidden" id="currentSpecialistId" th:value="${specialist.id}">
                <div class="search-wrapper2">
                  <input type="text" class="search1" placeholder="Найти клиента..." list="customerList" id="customerSearch">
                  <datalist id="customerList">

                  </datalist>
                </div>
              </div>
            </div>
            <div class="about-content-wrapper">
              <div class="about-content">
                <a class="about-us19" onclick="window.location.href = '/SimplePsy/V1/customer/customer-form'">Добавить клиента</a>
                <div class="news-container">
                  <a class="news10">Назначить встречу</a>
                  <b class="user-policy13">Добавить график нерабочих дней</b>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="icon-parent31">
          <img class="icon158" alt="" src="/images/icon-2@2x.png" />

          <div class="new-york-wrapper4">
            <b th:text="${specialist.city}" class="specialist-city"></b>
          </div>
        </div>
      </div>
    </header>
    <div class="user-panel-content-parent">
      <div class="user-panel-content">
        <div class="frame-parent144">
          <div class="wrapper-user-wrapper2">
            <div class="wrapper-user12">
              <img
                      class="user-icon"
                      loading="lazy"
                      alt=""
                      th:src="@{'/SimplePsy/V1/specialist/avatar/' + ${specialist.id}}"
                      id="userImage"
                      onclick="window.location.href='/SimplePsy/V1/specialist/personal-info'"
              />
            </div>
          </div>
          <div class="user-names-content-wrapper">
            <div class="user-names-content">
              <div class="hello-wrapper">
                <b class="hello">Привет, </b>
                <b th:text="${specialist.name}" class="hello" ></b>
                <b class="hello">!</b>
              </div>
              <b class="specialist-email">
                <p th:text="${specialist.username}" class="specialist-email-content"></p>
              </b>
            </div>
          </div>
          <div class="navigation-content-parent">
            <div class="frame-wrapper73">
              <div class="frame-parent122">
                <div class="frame-parent123">
                  <div class="client-list-wrapper">
                    <button class="base90" onclick="window.location.href='/SimplePsy/V1/specialist/customers';"></button>
                    <div class="icon-wrapper33">
                      <img class="icon146" alt="" src="/images/icon-3@2x.png" />
                    </div>
                    <b class="client-list">Список клиентов</b>
                  </div>
                  <div class="base-frame">
                    <button class="calendar-wrapper" id="baseContainer" onclick="window.location.href='/SimplePsy/V1/session/calendar';">
                      <div class="icon-wrapper34">
                        <img class="icon147" alt="" src="/images/icon-41@2x.png"/>
                      </div>
                      <b class="calendar">Календарь</b>
                    </button>
                  </div>
                </div>
                <div class="frame-parent123">
                  <div class="notifications-wrapper">
                    <button class="base90 fix-angle-base90" onclick="alert('Эта кнопка находится в разработке')"></button>
                    <div class="icon-wrapper33">
                      <img class="icon146" alt="" src="/images/icon-5.svg" />
                    </div>
                    <b class="notifications">Уведомления</b>
                  </div>
                  <div class="base-frame">
                    <button class="calendar-wrapper" id="baseContainer" onclick="alert('Эта кнопка находится в разработке')">
                      <div class="icon-wrapper34">
                        <img class="icon147" alt="" src="/images/icon-6.svg"/>
                      </div>
                      <b class="analytics">Аналитика</b>
                    </button>
                  </div>
                  <div class="tests-wrapper">
                    <button class="base94" onclick="window.location.href='/SimplePsy/V1/scoring/list';"></button>
                    <b class="surveys-tests">Опросники и тесты</b>
                  </div>
                </div>
              </div>
            </div>
            <div class="applications-content-wrapper">
              <div class="applications-content">
                <div class="wrapper49">
                  <b class="b143">Заявки</b>
                </div>
                <div class="frame-parent145">
                  <div class="frame-parent146" id="groupContainer">
                    <div class="rectangle-parent142">
                      <div class="frame-child168"></div>
                      <b class="application-item-icon">20.02.2024</b>
                    </div>
                    <div class="rectangle-parent143">
                      <div class="frame-child169"></div>
                      <b class="b144">Овсянникова Юля Матвеевна</b>
                    </div>
                  </div>
                  <div class="frame-parent147" id="groupContainer1">
                    <div class="rectangle-parent144">
                      <div class="frame-child170"></div>
                      <b class="b145">25.02.2024</b>
                    </div>
                    <div class="rectangle-parent145">
                      <div class="frame-child171"></div>
                      <b class="b146">Овсянникова Юля Матвеевна</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="client-card-actions">
        <div class="client-card-actions-content">
          <div class="frame-parent148">
            <button class="rectangle-parent146" onclick="window.location.href='/SimplePsy/V1/specialist/customers';">
              <div class="frame-child172"></div>
              <a class="a">Список клиентов</a>
            </button>
            <button class="rectangle-parent147" onclick="window.location.href='/SimplePsy/V1/session/sessions';">
              <div class="frame-child173"></div>
              <a class="a1">Список встреч</a>
            </button>
            <div class="rectangle-parent148" id="groupContainer" onclick="window.location.href='/SimplePsy/V1/scoring/list';">
              <div class="frame-child174"></div>
              <div class="div217">Опросники и тесты</div>
            </div>
          </div>
        </div>
        <div class="client-card-actions-inner">
          <div class="frame-parent149">
            <div class="rectangle-parent149">
              <div class="frame-child175"></div>
              <div class="div218" onclick="toggleEdit()">Редактировать</div>
            </div>
            <button type="submit" class="rectangle-parent150">
              <div class="div219">Сохранить</div>
            </button>
            <div class="rectangle-parent151">
              <div class="frame-child177"></div>
              <div class="div220">Ссылка на анкету</div>
            </div>
          </div>
        </div>
        <div class="component19">
          <div class="div221">Тип клиента</div>
          <div class="div222" th:text="${customer.typeOfClient.translation}"></div>
        </div>
        <div class="item113">
          <div class="div221">Статус клиента</div>
          <select id="client-type" th:name="${customer.typeOfClient}" th:field="*{typeOfClient}" disabled>
            <option value="CHILD">Ребенок</option>
          </select>
        </div>
          <div class="item113">
            <div class="div221">ФИО первого клиента</div>
            <input class="div222" th:name="${customer.firstClientSurname}" th:field="*{firstClientSurname}" disabled>
            <input class="div222" th:name="${customer.firstClientName}" th:field="*{firstClientName}" disabled>
            <input class="div222" th:name="${customer.firstClientLastName}" th:field="*{firstClientLastName}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Номер телефона первого клиента</div>
            <input class="div222" th:name="${customer.firstClientContact.phone}" th:field="*{firstClientContact.phone}" required disabled>
          </div>
          <div class="item113">
            <div class="div221">Почта первого клиента</div>
            <input class="div222" th:name="${customer.firstClientContact.email}" th:field="*{firstClientContact.email}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Пол первого клиента</div>
            <select class="div222" id="gender-1" th:name="${customer.firstClientSex}" th:field="*{firstClientSex}" disabled>
              <option value="MALE">Мужской</option>
              <option value="FEMALE">Женский</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">Запрос первого клиента на терапию: причина обращения</div>
            <textarea class="div222" th:name="${customer.firstClientRequestReason}" th:field="*{firstClientRequestReason}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">Запрос первого клиента на терапию: желаемый результат от прохождения терапии</div>
            <textarea class="div222" th:name="${customer.firstClientDesiredResult}" th:field="*{firstClientDesiredResult}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">ФИО второго клиента</div>
            <input class="div222" th:name="${customer.secondClientSurname}" th:field="*{secondClientSurname}" disabled>
            <input class="div222" th:name="${customer.secondClientName}" th:field="*{secondClientName}" disabled>
            <input class="div222" th:name="${customer.secondClientLastName}" th:field="*{secondClientLastName}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Номер телефона второго клиента</div>
            <input class="div222" th:name="${customer.secondClientContact.phone}" th:field="*{secondClientContact.phone}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Почта второго клиента</div>
            <input class="div222" th:name="${customer.secondClientContact.email}" th:field="*{secondClientContact.email}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Пол второго клиента</div>
            <select class="div222" id="gender-2" th:name="${customer.secondClientSex}" th:field="*{secondClientSex}" disabled>
              <option value="MALE">Мужской</option>
              <option value="FEMALE">Женский</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">Запрос второго клиента на терапию: причина обращения</div>
            <textarea class="div222" th:name="${customer.secondClientRequestReason}" th:field="*{secondClientRequestReason}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">Запрос второго клиента на терапию: желаемый результат от прохождения терапии</div>
            <textarea class="div222" th:name="${customer.secondClientDesiredResult}" th:field="*{secondClientDesiredResult}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">
              Каким способом обратился клиент/попечитель
            </div>
            <select class="div222" id="contact-method" th:name="${customer.typeOfTreatment}" th:field="*{typeOfTreatment}" disabled>
              <option value="MESSENGER">Мессенджер</option>
              <option value="SOCIAL_NETWORK">Социальная сеть</option>
              <option value="AGGREGATOR">Агрегатор</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">
              Дата первого обращения (запрос на консультацию)
            </div>
            <input type="date" class="div222" th:name="${customer.dateOfFirstRequest}" th:field="*{dateOfFirstRequest}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Дата первой консультации</div>
            <input type="date" class="div222" th:name="${customer.dateOfFirstConsultation}" th:field="*{dateOfFirstConsultation}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Предпочтительный формат встречи</div>
            <select class="div222" id="meeting-format" th:name="${customer.preferredMeetingFormat}" th:field="*{preferredMeetingFormat}" disabled>
              <option value="ONLINE" selected>Онлайн</option>
              <option value="OFFLINE">Оффлайн</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">
              Для онлайн выбрать/указать площадку взаимодействия
            </div>
            <select class="div222" id="online-platform" th:name="${customer.onlineMeetingPlace}" th:field="*{onlineMeetingPlace}" disabled>
              <option value="ZOOM">Zoom</option>
              <option value="TELEMOST">Телемост</option>
              <option value="GOOGLE_MEET">Google Meet</option>
              <option value="TELEGRAM">Telegram</option>
              <option value="WHATSAPP">WhatsApp</option>
              <option value="SKYPE">Skype</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">
              Для оффлайн выбрать адрес проведения встречи
            </div>
            <input class="div222" th:name="${customer.offlineMeetingPlace}" th:field="*{offlineMeetingPlace}" disabled>
          </div>
          <div class="item113">
            <div class="div221">
              Первичный/изначальный запрос клиента на терапию
            </div>
            <textarea class="div222" th:name="${customer.clientsFirstRequestForTherapy}" th:field="*{clientsFirstRequestForTherapy}"></textarea>
          </div>
          <div class="item113">
            <div class="div221">
              Фиксированное время/день недели для встречи (если да, то
              указать)
            </div>
            <input class="div222" th:name="${customer.fixedTimeForMeeting}" th:field="*{fixedTimeForMeeting}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Финансовые условия</div>
            <textarea class="div222" th:name="${customer.financialConditions}" th:field="*{financialConditions}" disabled></textarea>
          </div>
        </input>
      </div>
    </div>
    </div>
  </section>
  <section class="footer-content-wrapper">
    <div class="footer-content">
      <div class="feedback-content-wrapper">
        <div class="feedback-content">
          <img
                  class="icon164"
                  loading="lazy"
                  alt=""
                  src="/images/icon-7@2x.png"
          />

          <div class="frame-parent150" onclick="alert('Эта кнопка находится в разработке')">
            <div class="send-feedback-wrapper6">
              <b class="send-feedback12">Обратная связь</b>
            </div>
            <img
                    class="icon165"
                    loading="lazy"
                    alt=""
                    src="/images/icon-8.svg"
            />
          </div>
        </div>
      </div>
      <div class="client-details-content-parent">
        <div class="client-details-content">
          <div class="div244">Подробнее....</div>
        </div>
        <div class="client-details-form">
          <div class="item113">
            <div class="div221">Дата рождения</div>
            <input type="date" class="div222" th:name="${customer.dateOfBirth}" th:field="*{dateOfBirth}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Адрес проживания</div>
            <input class="div222" th:name="${customer.residentialAddress}" th:field="*{residentialAddress}" disabled>
          </div>
          <div class="item113">
            <div class="div221">
              Коллегиальные рекомендации (поле для заполнения кто вас
              порекомендовал клиенту)
            </div>
            <textarea class="div222" th:name="${customer.collegialRecommendations}" th:field="*{collegialRecommendations}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">Особые условия контракта</div>
            <textarea class="div222" th:name="${customer.specialTermsOfContract}" th:field="*{specialTermsOfContract}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">Семейное положение</div>
            <select class="div222" id="marital-status" th:name="${customer.familyStatus}" th:field="*{familyStatus}" disabled>
              <option value="MARRIED">Женат/Замужем</option>
              <option value="SINGLE">Холост/Незамужем</option>
              <option value="DIVORCED">В разводе</option>
              <option value="WIDOWED">Вдовец/Вдова</option>
              <option value="COHABITATION">Сожительство/Несостоявшийся брак</option>
              <option value="MARRIAGE_WITH_SEPARATE_HOUSING">Официальный брак с раздельным проживанием</option>
              <option value="LONELY">Одиночество/Не в постоянных отношениях</option>
              <option value="FAMILY_WITH_CHILDREN">Семьи с детьми</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">
              Приоритетный канал коммуникации (выпадающий список куда
              писать)
            </div>
            <select class="div222" id="preferred-communication-channel" th:name="${customer.priorityCommunicationChannel}" th:field="*{priorityCommunicationChannel}" disabled>
              <option value="TELEGRAM">Telegram</option>
              <option value="WHATSAPP">WhatsApp</option>
              <option value="VIBER">Viber</option>
              <option value="SKYPE">Skype</option>
              <option value="EMAIL">Почта</option>
              <option value="SNAPCHAT">Snapchat</option>
            </select>
          </div>
          <div class="item113">
            <div class="div221">
              Берется ли супервизия на данного клиента
            </div>
            <select class="div222" id="is-supervised" th:name="${customer.supervised}" th:field="*{supervised}" disabled>
              <option value="YES">Да</option>
              <option value="NO">Нет</option>
            </select>
          </div>

          <div id="supervisor-fields">
            <div class="item113">
              <div class="div221">ФИО супервизора</div>
              <input class="div222" type="text" id="supervisor-info" th:name="${customer.supervisorsSurname}" th:field="*{supervisorsSurname}" disabled>
              <input class="div222" type="text" th:name="${customer.supervisorsName}" th:field="*{supervisorsName}" disabled>
              <input class="div222" type="text" th:name="${customer.supervisorsLastName}" th:field="*{supervisorsLastName}" disabled>
            </div>
            <div class="item113">
              <div class="div221">Номер телефона супервизора</div>
              <input class="div222" type="tel" id="supervisor-phone" th:name="${customer.supervisorsContact.phone}" th:field="*{supervisorsContact.phone}" disabled>
            </div>
            <div class="item113">
              <div class="div221">Электронная почта супервизора</div>
              <input type="email" class="div222" th:name="${customer.supervisorsContact.email}" th:field="*{supervisorsContact.email}" disabled>
            </div>
            <div class="item113">
              <div class="div221">
                Материал для следующих сеансов из супервизии
              </div>
              <textarea class="div222" th:name="${customer.materialForNextSessionsFromSupervision}" th:field="*{materialForNextSessionsFromSupervision}" disabled></textarea>
            </div>
          </div>

          <div class="item113">
            <div class="div221">ФИО котерапевта</div>
            <input class="div222" type="text" id="cotherapist-info" th:name="${customer.cotherapistSurname}" th:field="*{cotherapistSurname}" disabled>
            <input class="div222" type="text" th:name="${customer.cotherapistName}" th:field="*{cotherapistName}" disabled>
            <input class="div222" type="text" th:name="${customer.cotherapistLastName}" th:field="*{cotherapistLastName}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Номер телефона котерапевта</div>
            <input type="tel" class="div222" th:name="${customer.cotherapistContact.phone}" th:field="*{cotherapistContact.phone}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Электронная почта котерапевта</div>
            <input type="email" class="div222" th:name="${customer.cotherapistContact.email}" th:field="*{cotherapistContact.email}" disabled>
          </div>
          <div class="item113">
            <div class="div221">Условия распределения гонорара между котерапевтами</div>
            <textarea class="div222" th:name="${customer.cotherapistPaymentConditions}" th:field="*{cotherapistPaymentConditions}" disabled></textarea>
          </div>
          <div class="item113">
            <div class="div221">Заметки</div>
            <textarea class="div222" th:name="${customer.notes}" th:field="*{notes}" disabled></textarea>
          </div>
        </div>
      </div>
    </div>
  </section>
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <div id="modal-body"></div>
    </div>
  </div>
</div>
</form>

<script>
  function toggleEdit() {
    document.querySelectorAll('input').forEach(function(input) {
      input.removeAttribute('disabled');
    });
    document.querySelectorAll('select').forEach(function(input) {
      input.removeAttribute('disabled');
    });
    document.querySelectorAll('textarea').forEach(function(input) {
      input.removeAttribute('disabled');
    });
    document.getElementById('saveButton').style.display = 'block';
  }
  function checkSupervisorFields() {
    const supervised = document.getElementById('is-supervised').getAttribute('value');
    document.getElementById('supervisor-fields').style.display = supervised === 'YES' ? 'block' : 'none';
  }

  // Initialize form
  checkSupervisorFields();

  // Открытие модального окна создания сессии
  document.addEventListener('DOMContentLoaded', function() {
    // Получаем элементы
    var modal = document.getElementById('modal');
    var modalBody = document.getElementById('modal-body');
    var closeBtn = document.querySelector('.close-btn');
    var appointLink = document.querySelector('.news10'); // Элемент "Назначить встречу"
    var holidayBtn = document.querySelector('.user-policy13');

    // Функция для открытия модального окна
    function openModal() {
      fetch('/SimplePsy/V1/session/session-form')
              .then(response => response.text())
              .then(data => {
                modalBody.innerHTML = data;
                modal.style.display = 'block';
              })
              .catch(error => console.error('Ошибка загрузки:', error));

      fetch(`/SimplePsy/V1/customer/findAll/${currentSpecialistId}`)
              .then(response => response.json())
              .then(clients => {
                const dataList = document.getElementById('clientsList');
                dataList.innerHTML = '';

                const script = document.createElement('script');
                script.id = 'dynamic-script';
                script.textContent = `
  document.getElementById('clientInput').addEventListener('change', function() {
    const selectedOption = Array.from(document.getElementById('clientsList').options).find(option => option.value === this.value);
    if (selectedOption) {
      const clientId = selectedOption.getAttribute('data-id');
      document.getElementById('clientId').value = clientId; // устанавливаем значение скрытого поля
    }
  });
  // Функция для валидации формы
  function validateForm() {
    const clientId = document.getElementById('clientId').value;
    if (!clientId) {
      document.getElementById('error-message').style.display = 'block'; // Показываем сообщение об ошибке
      return false; // Отменяем отправку формы
    }
    return true; // Разрешаем отправку формы, если значение есть
  }

  document.getElementById('clientInput').addEventListener('change', function() {
    const selectedOption = Array.from(document.getElementById('clientsList').options)
            .find(option => option.value === this.value);
    if (selectedOption) {
      const clientId = selectedOption.getAttribute('data-id');
      document.getElementById('clientId').value = clientId; // устанавливаем значение скрытого поля
      document.getElementById('error-message').style.display = 'none'; // Скрываем сообщение об ошибке при успешном выборе клиента
    } else {
      document.getElementById('clientId').value = ''; // Очищаем скрытое поле, если выбранного клиента нет в списке
    }
  });`;
                document.body.appendChild(script);
                clients.forEach(customer => {
                  const option = document.createElement('option');
                  switch (customer.typeOfClient) {
                    case 'ADULT':
                      option.value = customer.name + ' ' +customer.surname;
                      break;
                    case 'CHILD':
                      option.value = customer.childName + ' ' + customer.childSurname;
                      break;
                    case 'COUPLE':
                      option.value = customer.firstClientName + ' ' + customer.firstClientSurname;
                      break;
                    default:
                      // Здесь можно добавить код для обработки случая, если ни одно из значений не совпало
                      console.log('Unknown client type');
                      break;
                  }
                  option.setAttribute('data-id', customer.id);
                  dataList.appendChild(option);
                });
              })
              .catch(error => console.error('Ошибка:', error));


    }

    // Функция для закрытия модального окна
    function closeModal() {
      modal.style.display = 'none';
      const script = document.getElementById('dynamic-script');
      if (script) {
        script.remove();
        console.log('Скрипт удалён');
      } else {
        console.log('Скрипт не найден');
      }
    }

    function openHolidayModal()
    {
      const modal = document.getElementById("modal");
      const modalBody = document.getElementById("modal-body");

      fetch('/SimplePsy/V1/session/holiday')
              .then(response => response.text())
              .then(html => {
                modalBody.innerHTML = html;
                modal.style.display = "block";

                // Добавляем обработчик закрытия модального окна
                document.querySelector('.close-modal').onclick = function() {
                  modal.style.display = "none";
                };
              })
              .catch(error => {
                console.error('Error loading modal content:', error);
              });
    }

    // Закрытие модального окна при клике вне его содержимого
    window.onclick = function(event) {
      const modal = document.getElementById("modal");
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }

    appointLink.addEventListener('click', openModal);
    holidayBtn.addEventListener('click', openHolidayModal);
    closeBtn.addEventListener('click', closeModal);
  })
  const customerSearch = document.getElementById('customerSearch');
  const currentSpecialistId = document.getElementById('currentSpecialistId').value;

  customerSearch.addEventListener('input', function () {
    const query = customerSearch.value;

    if (query.length > 2) { // Запрашиваем данные только если введено больше 2 символов
      fetch(`/SimplePsy/V1/customer/findAll/${currentSpecialistId}`)
              .then(response => response.json())
              .then(customers => {
                const filteredCustomers = customers.filter(customer =>
                        customer.name.toLowerCase().includes(query.toLowerCase()) ||
                        customer.surname.toLowerCase().includes(query.toLowerCase())
                );

                const dataList = document.getElementById('customerList');
                dataList.innerHTML = ''; // Очищаем предыдущие результаты

                filteredCustomers.forEach(customer => {
                  const option = document.createElement('option');
                  option.value = `${customer.name} ${customer.surname}`;
                  option.dataset.id = customer.id;
                  dataList.appendChild(option);
                });
              });
    }
  });

  customerSearch.addEventListener('change', function () {
    const selectedOption = Array.from(document.querySelectorAll('#customerList option'))
            .find(option => option.value === customerSearch.value);

    if (selectedOption) {
      const customerId = selectedOption.dataset.id;
      window.location.href = `/SimplePsy/V1/customer/customer-card/${customerId}`; // Передача username через GET-параметр
    }
  });
</script>
</body>
</html>
